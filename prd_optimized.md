# PPT模板文字替换程序 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目背景
开发一个自动化工具，实现PPT模板中特定占位符的文字替换功能，用于生成标准化的报告演示文稿。

### 1.2 核心目标
- 保持PPT模板的原有格式和布局不变
- 自动替换指定占位符内容
- 确保替换后文字符合格式规范

## 2. 功能需求

### 2.1 核心功能
**PPT模板文字替换**
- 输入：PPT模板文件 + 替换内容配置
- 处理：查找并替换指定占位符
- 输出：格式化后的新PPT文件

### 2.2 具体要求

#### 2.2.1 模板处理规则
- **严格保持**：除替换区域外，模板的所有内容、格式、布局保持不变
- **精确替换**：仅替换指定的占位符区域
- **格式继承**：新内容继承模板中相应区域的基础格式

#### 2.2.2 文字格式规范
- **基础字体**：微软雅黑，14号
- **行间距**：1.5倍行距
- **特殊格式**：
  - 冒号前的文字：红色 + 加粗
  - 数字（包括百分号）：仅红色，不加粗
  - 其他文字：保持基础格式

#### 2.2.3 占位符定义
- `{{analysis_text1}}` - 收入分析内容
- `{{analysis_text2}}` - 保有率分析内容

## 3. 技术需求

### 3.1 输入文件
- **模板文件**：`file/ces.pptx`
- **数据格式**：文本内容，支持多段落

### 3.2 输出要求
- **文件格式**：.pptx
- **命名规则**：建议添加时间戳或版本号
- **兼容性**：确保在主流Office版本中正常显示

### 3.3 处理逻辑
1. **读取模板**：加载指定PPT模板文件
2. **定位占位符**：查找所有`{{}}`格式的占位符
3. **内容替换**：将占位符替换为对应内容
4. **格式应用**：对替换内容应用格式规范
5. **保存输出**：生成新的PPT文件

## 4. 数据内容

### 4.1 替换内容1 (`{{analysis_text1}}`)
```
整体收入小幅波动：2025年6月，辽宁全球通客户收入整体变化不大，拍照全球通收入占比普遍较高，其中大连、沈阳、营口收入规模较大。

丹东收入增长显著：丹东全球通客户收入环比增长 3.18%，是唯一实现正增长的地市，表现较为突出。

沈阳收入最高：沈阳以 1.71亿元 的全球通客户收入位居全省第一，占全省总收入的 30.85%。

多数地市收入下降：除丹东外，其余13个地市全球通客户收入均出现环比下降，其中阜新、锦州、朝阳降幅较大，分别下降 9.31%、1.79%、7.24%，需重点关注。

鞍山收入回升明显：鞍山全球通客户收入环比增长 2.41%，是少数实现增长的地市之一，表现较为积极。
```

### 4.2 替换内容2 (`{{analysis_text2}}`)
```
整体保有率较高：2025年6月，辽宁全球通客户拍照规模保有率整体表现良好，除葫芦岛外，其余地市均高于 96%，表明客户稳定性较强。

葫芦岛保有率偏低：葫芦岛拍照全球通规模保有率为 95.7%，是唯一低于 96% 的地市，需重点关注客户流失原因。

沈阳表现最佳：沈阳以 97.6% 的保有率位居全省第一，客户稳定性表现突出。

抚顺、朝阳、本溪保有率较低：抚顺、朝阳、本溪保有率分别为 96.5%、96.5%、96.3%，均低于全省平均水平，需加强客户维系措施。
```

## 5. 非功能需求

### 5.1 性能要求
- 处理速度：单个PPT文件处理时间 < 10秒
- 文件大小：支持最大50MB的PPT文件

### 5.2 可用性要求
- 操作简单：命令行界面，一键执行
- 错误处理：提供明确的错误提示和处理建议
- 日志记录：记录处理过程和结果

### 5.3 扩展性要求
- 支持配置文件：便于添加新的占位符和替换规则
- 模板通用性：支持不同的PPT模板格式

## 6. 验收标准

### 6.1 功能验收
- [ ] 成功替换所有指定占位符
- [ ] 模板其他内容完全保持不变
- [ ] 文字格式完全符合规范要求
- [ ] 生成的PPT文件可正常打开和编辑

### 6.2 格式验收
- [ ] 冒号前文字为红色加粗
- [ ] 数字和百分号为红色但不加粗
- [ ] 基础字体为微软雅黑14号
- [ ] 行间距为1.5倍行距
- [ ] 段落结构清晰合理

## 7. 命令行接口设计

### 7.1 基本用法
```bash
python ppt_replacer.py --template <模板文件路径> --output <输出文件路径>
```

### 7.2 命令行参数
- `--template` / `-t`：指定PPT模板文件路径
- `--output` / `-o`：指定输出文件路径（可选，默认为模板文件名_updated.pptx）
- `--config` / `-c`：指定配置文件路径（可选，默认使用内置配置）
- `--verbose` / `-v`：显示详细处理信息
- `--help` / `-h`：显示帮助信息

### 7.3 使用示例
```bash
# 基本用法
python ppt_replacer.py -t file/ces.pptx

# 指定输出文件
python ppt_replacer.py -t file/ces.pptx -o report_2024.pptx

# 使用详细模式
python ppt_replacer.py -t file/ces.pptx -v
```

## 8. 实施建议

### 8.1 技术选型
- **推荐语言**：Python（丰富的PPT处理库）
- **核心库**：python-pptx 或 COM组件
- **开发环境**：支持Windows平台

### 8.2 开发阶段
1. **阶段1**：基础替换功能实现
2. **阶段2**：格式控制功能实现  
3. **阶段3**：错误处理和优化
4. **阶段4**：命令行参数和配置功能

---
*文档版本：v1.0*  
*最后更新：2024年*